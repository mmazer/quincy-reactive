define("quincy/events",function(t,n){function e(){return++c}function i(t,n,i){this.events=t,this.fn=n,this.context=i,this.count=0,this.paused=!1,this.uid=e()}function r(t){this.event=t,this.listeners=[]}function o(t){t.clear()}function u(t,n,e){if(!t instanceof r)throw new TypeError("listenTo: EventStream required");return t.forEach(n,e)}var s=t("quincy"),c=0;i.prototype.equals=function(t){return t&&this.uid===t.uid},i.prototype.pause=function(){return this.paused=!0,this},i.prototype.resume=function(){return this.paused=!1,this},i.prototype.dispose=function(){this.events&&this.events.remove(this),this.clear()},i.prototype.clear=function(){this.events=this.fn=this.context=null},i.prototype.notify=function(){return!this.paused&&s.isFunction(this.fn)?(this.fn.apply(this.context,arguments),this.count++,this):void 0},r.prototype.forEach=function(t,n){if(!s.isFunction(t))throw new TypeError("function required for stream listener");var e=new i(this,t,n);return this.listeners.push(e),e},r.prototype.remove=function(t){if(!t||this!==t.events)return this;for(var n=this.listeners.length;n--;)if(this.listeners[n].equals(t)){this.listeners.splice(n,1);break}return this},r.prototype.removeAll=function(){s.forEach(o,this.listeners),this.listeners=[]},r.prototype.emit=function(t){t=arguments.length>0?t:s.valueOf(this.event);for(var n,e=0,i=this.listeners.slice(),r=0,o=i.length;o>r;r++)n=i[r],n.paused||(n.notify(t),e++);return e},r.prototype.merge=function(t){return r.merge(this,t)},r.prototype.collect=function(t,n,e){if(!s.isFunction(t)||!s.isFunction(n))throw new TypeError("EventStream.collect: function required");var i=new r;return this.forEach(function(r){t.call(e,r)&&i.emit(n.call(e,r))}),i},r.prototype.filter=function(t,n){if(!s.isFunction(t))throw new TypeError("Event stream filter predicate requires a function");return this.collect(t,s.identity,n)},r.prototype.map=function(t,n){if(!s.isFunction(t))throw new TypeError("Event stream map requires a function");return this.collect(s.always,t,n)},r.prototype.flatMap=function(t,n){var e,i=new r;return this.forEach(function(o){e&&e.dispose();var u=t.call(n,o);u instanceof r&&(e=u.forEach(function(t){i.emit(t)}))}),i},r.prototype.fold=function(t,n){var e=new r,i=n;return this.forEach(function(n){i=t.call(null,i,n),e.emit(i)}),e},r.prototype.distinct=function(t){var n,e=new r;return t||(t=s.eqs),this.forEach(function(i){t(n,i)||(n=i,e.emit(i))}),e},r.prototype.throttle=function(t){var n,e=new r,i=function(){void 0!==n&&e.emit(n),n=void 0},o=setTimeout(i,t);return this.forEach(function(e){clearTimeout(o),n=e,o=setTimeout(i,t)}),e},r.prototype.pipe=function(t){if(t&&!(t instanceof r))throw new TypeError("Invalid event stream for pipe");return t=t||r.create(),this.forEach(function(n){t.emit(n)}),t},r.prototype.broadcast=function(){return s.forEach(function(t){t instanceof r&&this.pipe(t)},arguments,this),this},r.prototype.once=function(){var t=r.create(),n=this.forEach(function(e){t.emit(e),n.dispose()});return t},r.prototype.take=function(t){var n=r.create(),e=this.forEach(function(i){n.emit(i),e.count>t&&e.dispose()});return n},r.prototype.takeAfter=function(t){var n=r.create(),e=0;return this.forEach(function(i){++e>t&&n.emit(i)}),n},r.prototype.takeWhile=function(t,n){if(!s.isFunction(t))throw new TypeError("Event stream takeWhile requires a function");var e=r.create(),i=this.forEach(function(r){t.call(n,r)?e.emit(r):i.dispose()});return e},r.prototype.takeUntil=function(t,n){if(!s.isFunction(t))throw new TypeError("Event stream takeUntil requires a function");return this.takeWhile(s.complement(t),n)},r.prototype.defer=function(t){t=t||100;var n=r.create();return this.forEach(function(e){setTimeout(function(){n.emit(e)},t)}),n},r.prototype.countListeners=function(){return this.listeners.length},r.Listener=i,r.create=function(t){return new r(t)},r.createStreams=function(t){var n={};return s.forEach(function(t,e){n[e]=r.create(t)},t),n},r.merge=function(){var t=r.create(),n=function(n){r.prototype.emit.call(t,n)},e=s.isArray(arguments[0])?arguments[0]:arguments;return s.forEach(function(t){t instanceof r&&t.forEach(n)},e),t},r.listenTo=u,n.exports=r}),define("quincy/signal",function(t,n){function e(t,n,e){this.value=t,this.events=new o,this.comparator=n||r.eqs,this.notification=r.isFunction(e)?e:void 0}function i(t){e.call(this,t||[])}var r=t("quincy"),o=t("quincy/events");e.prototype.val=function(){return 0===arguments.length?r.valueOf(this.value):this.update(arguments[0])},e.prototype.now=function(){return r.valueOf(this.value)},e.prototype.update=function(t){e.isReadonly(this)||this.equals(t)||(this.value=t,this.notify())},e.prototype.equals=function(t){return this.comparator(this.value,t)},e.prototype.map=function(t){return this.collect(r.always,t)},e.prototype.filter=function(t){return this.collect(t,r.identity)},e.prototype.collect=function(t,n){if(!r.isFunction(t))throw new TypeError("Signal.collect: predicate must be a function");r.isFunction(n)||(n=r.identity);var i=this.now(),u=t(i)?new e(n(i)):new e;return o.listenTo(this.events,function(e){t(e)&&u.update(n(e))}),u},e.prototype.fold=function(t,n){var i=t.call(null,n,this.now()),r=new e(i);return this.forEach(function(n){i=t.call(null,i,n),r.update(i)}),r},e.prototype.reduce=function(t){var n=this.now(),i=new e(n);return this.forEach(function(e){n=t.call(null,n,e),i.update(n)}),i},e.prototype.unset=function(){this.val(void 0)},e.prototype.notify=function(){var t=this.notification?this.notification(this.now(),this):this.now();this.events.emit(t)},e.prototype.forEach=function(t,n){return this.events.forEach(t,n)},e.prototype.proxy=function(){return this._proxy||(this._proxy=this.val.bind(this)),this._proxy},e.prototype.zip=function(t){return e.zip(this,t)},e.create=function(t){return new e(t)},e.isReadonly=function(t){return r.isFunction(t.value)},e.constant=function(t){return new e(function(){return t})},e.derive=function(t){var n=new e(t),i=function(){n.notify()};return r.forEach(function(t){t instanceof e&&t.forEach(i)},r.tail(arguments)),n},e.zip=function(){var t=r.toArray(arguments),n=new e(function(){return r.map(function(t){return t.val()},t)}),i=function(){n.notify()};return r.forEach(function(t){t instanceof e&&t.forEach(i)},t),n},e.map=function(t){return r.mapProps(function(t){return new e(t)},t)},i.prototype.constructor=r.createObject(e.prototype),r.assign(i.prototype,{notify:function(t){t.value=this.value,this.events.emit(t)},update:function(t){var n=this.diff(t);(n.add||n.remove)&&(this.value=t,this.notify(n))},diff:function(t){var n={},e=this.now();return n.add=r.filter(function(t){return!r.contains(t,e)},t),n.remove=r.filter(function(n){return!r.contains(n,t)},e),n}}),e.ArraySignal=i,e.fromArray=function(t){return new i(t||[])},n.exports=e});